<app-manager-dash-board></app-manager-dash-board>
<br><br>

<div class="py-5 " style="padding-left: 9rem;padding-right: 9rem;">
  <!-- <div class="container"> -->
  <div class="row col-md-12 ">
    <h3 style="margin-left: 25rem;">REPORTS ON INSPECTION</h3>
  </div>
</div>

<div style="margin-left: 1.5rem;margin-right: 1.5rem;" class="row bg-info col-md-12">
  <div class="col-md-6">
    <h1 style="text-align: right"></h1>
    <!-- <form class="" method="post" action="https://formspree.io/"> -->
    <div class="form-group" style="width: 25rem;">
      <label>From Date</label>

      <igx-datePicker [value]="date" [(ngModel)]="fromdate"></igx-datePicker>
    </div>
    <div class="form-group">
      <label>Supervisor</label>
      <select [(ngModel)]="SupervisorKey" style="width: 50%; background-color: #d4f4ff;">
        <option value="">--Select--</option>
        <option *ngFor="let s of supervisoroptions" [value]="s.SupervisorKey">
            {{s.SupervisorText}}
        </option>
      </select>
    <!-- </form> -->
    </div>
  </div>
  <div class="col-md-6">
      <!-- <form class="" method="post" action="https://formspree.io/"> -->
    <div class="form-group">
      <label>To Date</label>
      <igx-datePicker [value]="date" [(ngModel)]="todate"></igx-datePicker>
    </div>
  </div>
</div>
<div class="bg-info" style="text-align:center">
<button type="button"  class="btn btn-primary" (click)=generateInspectionReport(fromdate,todate,SupervisorKey)>Generate</button>
</div>


<div style="margin-left: 1.5rem;margin-right: 1.5rem;"></div>
<table *ngIf='viewinspectionReport' class="table table-hover table-responsive table-bordered table">
  <thead class="tableHead">
    <!-- <tr> -->
    <th> Template </th>
    <th> Date </th>
    <th> Location</th>
    <th>Auditor</th>
    <th> Employee</th>
    <th>Status</th>
    <!-- </tr> -->
  </thead>
  <tbody>
    <tr *ngFor="let x of viewinspectionReport" [value]="x.InspectionOrderKey">
      <td>{{x.TemplateName}}</td>
      <td>{{x.InspectionDate}}</td>
      <td id="tooltip">{{x.FacilityName}} - {{x.RoomId}}<span id="tooltip-span" style="color:white;">{{x.RoomType}}</span></td>
      <td>{{x.LastName}},{{x.FirstName}}</td>
      <td>{{x.EmployeeName}}</td>
      <td *ngIf="x.InspectionCompletedBy !== null">Inspection Completed</td>
      <td *ngIf="x.InspectionCompletedBy === null "> Inspection Not Completed</td>
    </tr>
  </tbody>
</table>
<div style="text-align:center">
  <button type="button" *ngIf='viewinspectionReport'  class="btn btn-primary" (click)="exportToExcel()">Export To Excel</button>
  </div>
